using System;
using System.Collections.Generic;
//using System.Linq;

using static System.Console;

public class Program
{
    public static void Main()
    {
        var s = new YoutubeChannel("state 1");
        s.AttachRange(
            new List<Observer>()
            {
                new YoutubeSubscriber("ob1"),
                new YoutubeSubscriber("ob2"),
                new YoutubeSubscriber("ob3")
            }
        );

        s.SetState("Text Changed!");
        ReadKey();
    }
}

public abstract class Observer
{
    public abstract void Update(string state);
}

public abstract class Subject
{
    protected string SubjectState;

    protected List<Observer> Observers = new List<Observer>();

    public virtual void Attach(Observer o) => Observers.Add(o); 
    public virtual void AttachRange(List<Observer> o) =>Observers.AddRange(o);
    public virtual void Detach(Observer o) => Observers.Remove(o);

    public abstract void SetState(string state);

    protected virtual void Notify()=>
        Observers.ForEach(o => o.Update(this.SubjectState));
}

public class YoutubeChannel : Subject
{
    public YoutubeChannel(string state)=>
        SetState(state);
        
    public override void SetState(string state)
    {
        if (this.SubjectState != state)//when the state changes set it
        {
            SubjectState = state;
            Notify();//notify the subscribers
        }
    }
}

public class YoutubeSubscriber : Observer
{
    private string Name { get; set; }
    public YoutubeSubscriber(string name)=>this.Name = name;
    

    public override void Update(string state)=>
        Console.WriteLine($"Observer{Name} notified. New Subject state{state}");
    

}
